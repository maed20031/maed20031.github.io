---
title: "수리통계학 Chapter 2"
excerpt: 
categories:
 - Statistics
tags:
 - Statistics
use_math: true
toc: true
toc_sticky: true
---

# 2 Transformations and Expectations

확률변수의 함수들은 어떻게 다루는지 살펴보자.

## 2.1 Distributions of Functions of a Random Variable

$X$가 확률변수라면 함수 $g$에 대해서 $Y = g(X)$도 확률변수가 된다. 그러면 $Y$의 분포함수는 어떻게 생겼을까?

먼저  $g$는 어떤 함수인지 보자. 함수 $g$는 이렇게 정의된다.

\[
g(x) : \mathcal{X \to Y}
\]

각 $\mathcal{X, Y}$는 확률변수 $X,Y$의 표본공간이다.

그 다음 $g$의 역함수 inverse mapping을 생각해보자.

\[
g^{-1}(A) = \{x \in \mathcal X : g(x) \in A\}
\]

위에서 $A$는 집합이다. 당연히 $A$는 원소 하나만 갖는 집합일 수 있고 그 경우에는 편의상 다음과 같이 쓴다.

\[
g^{-1}(\{y\}) = g^{-1}(y) = P(\{x \in \mathcal X : g(x) = y \})
\]

이제 $P(Y)$를 정의해보자.



$$
\begin{align*}
P(Y \in A) &= P(g(X) \in A)\\
&= P(\{x \in \mathcal X : g(x) \in A\})\\
&= P(X \in g^{-1}(A))
\end{align*}
$$

위의 식이 확률 공리를 만족하는지 쉽게 확인 가능하다.

확률변수들의 함수를 사용할 때 표본공간의 변화에 주의할 필요가 있다. 
$X \mapsto g(X) = Y$라고 할때 표본공간을 다음과 같이 쓴다.

$$
\mathcal X = \{x : f_X(x) > 0\}, \ \mathcal Y = \{y : y = g(x) \text{ for some } x \in \mathcal X \}
$$

$g$ 단조함수라고 해보자. 그러면 $g$는 일대일 함수가 되고 모든 $x \in \mathcal X$에 대응하는 $y \in \mathcal Y$가 각각 유일하게 존재한다.

따라서 $g$가 단조증가일 경우

$$
\{x \in \mathcal X : g(x)\le y\} = \{x \in \mathcal X : g^{-1}g(x)) \le g^{-1}(y)\}\
= \{x \in \mathcal X : x \le g^{-1}(y)\}
$$

단조 감소일 경우는 부등호의 방향을 모두 반대로 해준다.

그러면 이제 $F_Y(y)$를 정의해 줄 수  있다. $g$가 단조증가일 경우

$$
    F_Y(y) = \int_{\{x \in \mathcal X : x \le g^{-1}(y)\}} f_X(x)dx = \int_{-\infty}^{g^{-1}(y)} f_X(x)dx = F_X (g^{-1}(y))
$$

결과를 정리하면 다음과 같다.

**정리 1.1**

확률변수 $X$의 분포함수를 $F_X(x)$, $Y = g(X)$라 하고 두 확률변수의 표본공간을 $\mathcal {X, Y}$라 하자. 그러면 다음이 성립한다.

1. $g$가 단조 증가일 경우 $F_Y(y) = F_X(g^{-1}(y)$)
2. $g$가 단조 감소일 경우 $F_Y(y) = 1 - F_X(g^{-1}(y))$

**정리 1.2**

정리 1.1와 같은 가정에서 $f_X(x)$가 연속이고 $g^{-1}(y)$가 연속인 도함수를 가진다고 하자. 그러면 $Y$의 pdf는 다음과 같다.

$$
f_Y(y)  =  f_X(g^{-1}(y) \bigg| \frac{d}{dy} g^{-1}(y) \bigg |,  \ y \in \mathcal Y
$$

증명

각각 chain rule을 적용해서 미분을 해보면 절대값을 이용해 위와 같이 하나의 식으로 쓸 수 있음을 알 수 있다.

하지만 모든 함수가 항상 단조함수는 아니다. 따라서 위의 두 정리를 사용할 수 없는 경우가 있다. 하지만 표본 공간을 적당히 나눠서 단조함수들의 합으로 나타낼 수 있다면 어떨까?

**예시 1.1**

$X$가 연속형 확률변수고 $Y = X^2$를 생각해보자. 그러면 

$$
\begin{align*}
F_Y(y) &= P(Y \le y) = P(X^2 \le y) = P(-\sqrt y \le X \le \sqrt y)\\
 &= F_X(\sqrt Y)  - F_X(-\sqrt y)
\end{align*}
$$

라는 식을 얻는다. 미분하면 

$$
 f_Y(y) = \frac{1}{2\sqrt{y}} \left(f_X(\sqrt y) + f_X(-\sqrt y)\right)
$$

를 얻는다. 

$Y$의 pdf를 살펴보면 두 함수의 합으로 이루어져 있다. 각 함수는 $g$가 단조함수로 표현될 수 있는 두 부분을 각각 나타낸다는 것을 알 수 있다. $x > 0, x< 0$.

**정리 1.3**

$X$가 pdf $f_X(x)$를 갖고, $Y = g(X)$라 하자. $A_0, A_1, ..., A_k$가 표본공간 $\mathcal X$의 분할이고 $P(X \in A_0) = 0$, $f_X$가 나머지 집합들 위에서 모두 연속이라 하자. 그리고 각 함수 $g_1(x), ... g_k(x)$가 각 구간들 위에서 다음을 만족한다고 하자.

1. $g(x) = g_i(x), \quad x \in A_i$
2. $g_i(x)$는 단조함수
3. 집합 $\mathcal Y_i = \{y : y =g_i(x),  x \in A_i\}$가 $i$에 상관없이 모두 같다.
4. $g_i^{-1}(y)$가 연속인 도함수를 가진다. 

그러면 
$$
 f_Y(y) = \sum^k_{i=1} f_X(g_i^{-1}(y)) \left | \frac{d}{dy} g_i^{-1}(y)\right | , \quad y \in \mathcal Y
$$

조건이 상당히 많아서 어지럽다. 하지만 표본공간을 분할한 다음 각 집합 위에서 정리 1.2를 각각 적용한 것에 불과하다.

**정리 1.4**

$X$의 분포함수가 연속이고 $Y = F_X(X)$라 하자. 그러면 $Y$는 Uniform $(0,1)$이다. 

증명

$$
\begin{align*}
P(Y \le y) &= P(F_X(X) \le y)\\
&= P(X \le F_X^{-1}(y))\\
&= F_X(F_X^{-1}(y))\\
&= y
\end{align*}
$$

이 정리는 프로그램을 통해 실제 난수를 생성할때 잘 활용된다. Chapter 5에서 다시 등장한다.

## 2.2 Expected Values

영어로는 average, mean 두 단어를 써서 각각 다른 느낌을 주는 지는 잘 모르겠다. 우리말로 "평균"이라 하면 다 더해서 나눠준다는 것이 제일 먼저 떠오른다. 하지만 나눠주는 것은 별 의미가 없다. 중요한것은 뭘 어떻게 더하는 가이다.

**정의 2.1**

기대값을 확률변수에 따라 다음과 같이 정의한다.

$$
Eg(X) = 
\begin{cases}
  \int g(x)f_X(x)dx & \text{ continuous }\\
  \sum g(x)f_X(x) & \text{ discrete }
\end{cases}
$$

만약 $E\mid g(x)\mid = \infty$일 경우 기대값이 존재하지 않는다고 하며 유한할 경우 기대값이 존재한다고 한다.

해석학이나 측도론을 배웠다면 두 식은 하나의 식으로 묶어서 쓸 수 있다. 여기서는 다루지 않는다.

**예 2.1 지수분포**

$X \sim Exp(\lambda)$라 하자. 그러면

$$
 EX = \int_0^\infty \frac{1}{\lambda}xe^{-x/\lambda}dx\\
 = \lambda
$$

따라서 기대값은 $\lambda$가 된다.

**예 2.2 코시분포**

코시분포는 기대값이 존재하지 않는 분포의 대표적인 예이다. 한 번 보자.

$$
 E|X| = \int \frac{|x|}{\pi(1+x^2)}dx\\
 = 2\int_0^\infty \frac{x}{\pi(1+x^2)}\\
 = \lim_{t \to \infty} \log(1 + t^2)/ \pi = \infty
$$

따라서 기대값이 존재하지 않는다.

절대값의 기대값으로 계산했다는 것을 주의 깊게 봐야한다. 그냥 $EX$로 계산하면 존재하는 거 아닌가? 라는 의문에 빠질 수 있다.


기대값의 성질을 알아보자.

**정리 2.1**

$X$는 확률변수 $a,b,c$는 상수, $g_1(X), g_2(X)$의 기대값이 존재한다고 하자. 그러면 

1. $E[ ag_1(X) + bg_2(X) + c] = aEg_1(X) + bEg_2(X) + c$
2. 모든 $x$에 대해 $g_1 \ge 0$ 이면  $Eg_1 \ge 0$
3. 모든 $x$에 대해 $g_1 \ge g_2$ 이면  $Eg_1 \ge Eg_2$
4. 모든 $x$에 대해 $a \le g_1 \le b$ 이면  $a \le Eg_1 \le b$

증명 

연속형 확률변수에 대해서 증명한다. 이산형도 비슷하게 증명된다.

적분은 linear property를 가진다. 즉 $\int af + bg = a\int f+ b\int g$이다. 기대값이 적분을 통해 정의되므로 1번은 당연히 성립한다. 

$g_1$이 항상 0보다 크다면 $g_1(x)f(x)$도 항상 0보다 크다. 항상 0보다 큰 함수를 적분하면 적분값도 양수다.

새 함수 $g_3 := g_1 - g_2$를 정의해서 2번을 적용하면 $Eg_3(X) \ge 0$을 얻고 1번의 linear property를 사용하면 3번을 얻는다.

$g_2 = a, g_3 =b$라 하고 3번을 두번 적용하면 얻을 수 있다.


## 2.3 Moments and Moment Generating Functions

**정의 3.1** 

자연수 $n$에 대해 $n$차 적률 moment를 다음과 같이 정의한다.

$$ \mu'_n = EX^n $$ 

$n$차 중심 적률도 다음과 같이 정의한다.

$$ \mu_n = E(X - EX)^n $$.

**정의 3.2**

$X$의 분산 (2차 중심 적률)은 다음과 같이 정의한다.

$$
E(X - EX)^2
$$

분산의 양의 제곱근 값을 표준편차라고 한다.

3,4 차 중심 적률값도 이름이 있지만 1,2 차 즉 평균,분산이 가장 많이 활용된다.

**정리 3.1**

$X$의 분산이 유한하다고 하자. 그러면 상수 $a,b$에 대해 

$$
    Var(aX + b) = a^2Var(X)
$$

증명

$$
\begin{align*}
    Var(aX +b) &= E[(aX + b) - E(aX + b)]^2\\
    &= E(aX - aEx)^2\\
    &= a^2 E(X - EX)^2\\
    &= a^2 Var(X)
\end{align*}
$$

즉 상수를 더하고 빼는 것은 분산에는 아무런 영향을 주지 않는다. 

적률을 계산하는 방법은 정의를 이용한 방법과 적률생성함수를 사용하는 것이 있다. 적률생성함수가 뭐지 알아보자.

**정의 3.3**

확률변수 $X$의 적률생섬함수 Moment Generating Function은 다음과 같다.

$$
M_X(t) = E e^{tX}
$$

우변의 기대값이 0 주변에서 존재해야 한다.

0 주변이라는 것은 적당한 구간 (-h, h)를 말한다. 사실 -h,h로 절대값이 같다는 것은 중요하지 않다. 0이 포함된 열린 구간이라는 것이 중요하다.

0이 포함된 구간위에서 기대값이 유한하지 않다면 MGF가 존재하지 않는다고 한다.

**정리 3.2**

$X$의 MGF가 존재한다면 $EX^n = M_X^{(n)}(0)$

증명

적분과 미분의 순서를 바꿀 수 있다고 가정하자. 일반적으로는 가능하지 않다.

$$
\begin{align*}
    \frac{d}{dt} M_X(t) &= \frac{d}{dt}\int e^{tx}f_X(x)dx\\
    &= \int \frac{d}{dt}e^{tx} f_X(x)dx\\
    &= \int xe^{tx}f_X(x)dx\\
    &= EXe^{tX}
\end{align*}
$$

$t = 0$을 대입하면 $EX$를 얻는다.

$n$이 크다면 반복적으로 미분해서 0을 대입하면 된다. 반복적으로 미분하면 $EX^ne^{tX}$를 얻는다. 

이 정리를 보면 왜 이렇게 해서 구하는지 이해가 가지 않는다. 정의대로 하면 적분 한번만 하면 되는걸 MGF를 구하고 여러번 미분까지 한다.

MGF가 중요한 이유는 적률을 구하는 방법보다는 MGF를 통해 분포의 성질을 알 수 있기 때문이다. 불편하긴 하지만 MGF가 존재한다면 모든 차수의 적률을 구할 수 있다. 다시 말하면 도든 차수의 적률이 존재한다는 것을 알 수 있다. 그러면 반대로 모든 차수의 적률을 알고 있다면 MGF를 구할 수 있을까?

**예 3.1**

두 pdf를 살펴보자.

$$
\begin{align*}
  f_1(x) &= \frac{1}{\sqrt{2\pi}x} \exp{(-\log x)^2/2}\\
  f_2(x) &= f_1(x)[1 + \sin{2\pi\log x}]
\end{align*}
$$

적당한 계산을 통하면 두 분포의 적률이 모든 차수에서 같다는 것을 보일 수 있다. 하지만 두 분포 모두  MGF가 존재하지 않는다. 따라서 MGF가 존재하다는 것은 MGF로 정의되는 적률을 갖는 분포는 하나로 유일하다는 것이다.

**정리 3.3**

$F_X, F_Y$를 모든 적률이 존재하는 두 분포의 분포함수라 하자.

1. $X, Y$가 유한한 지지집합을 갖는 경우 모든 $u, r$에 대해 $F_X(u) = F_Y(u)$와 $EX^r = EY^r$은 동치이다.
2. MGF가 존재하고 $M_X(t) = M_Y(t)$라면 $F_X = F_Y$이다.

증명은 이 노트의 범위를 벗어난다. 다음 정리의 증명도 범위를 벗어난다.

**정리 3.4**

$\{X_i\}$가 각각 $M_{X_i}(t)$를 가진다고 하자. 그리고 적당한 0 근방에서 모든 $t$에 대해
\[ \lim_{i \to \infty} M_{X_i}(t) = M_X(t) \]
라 하고 $M_X$도 MGF라 하자. 그러면 $M_X$로 정의된 적률을 갖는 분포함수 $F_X$가 존재하고 $F_X$가 연속인 곳에서 다음이 성립한다.
\[ \lim_{i \to \infty} F_{X_i}(x) = F_X(x) \]


MGF가 수렴한다면 그에 대응하는 분포가 존재한다는 말이다. 증명은 라플라스 변환을 사용하면 할 수 있다. 사실 MGF가 라플라스 변환의 일종이다. 라플라스 변환이 언제 존재하는지를 보면 MGF가 존재한다는 것이 어떤 뜻인지 알 수 있다.

**정리 3.5**

\[ M_{aX + b}(t) = e^{bt}M_X(at) \]

적분의 성질을 통해 쉽게 보일 수 있다.

## 2.4 Differentiating Under an Integral Sign

MGF를 계산할 때 적분과 미분의 순서를 바꿀 수 있다는 것을 가정했다. 정확히는 극한과 적분의 순서를 바꾸는 것이다.  르벡의 지배수렴정리 Dominated Convergence Theorem 가 적절한 조건 하에서 극한과 적분의 순서을 바꿀 수 있다는 것을 보여준다.

이 정리에 대한 소개와 증명은 많은 내용을 필요로 하므로 전제 조건이 무엇인지만 알아 보자.

**정리 4.1**

함수 $h(x,\theta)$가 모든 $x$에 대하여 $\theta = \theta_0$에서 연속이고 다음을 만족하는 함수 $g$가 존재한다고 하자.

1. 모든 $x,\theta$에 대해 $\mid h(x,\theta)\mid \le g(x)$
2. $\int g(x)dx < \infty$

그러면 

$$
\lim_{\theta\to\theta_0}\int h(x,\theta)dx = \int \lim_{\theta\to\theta_0}h(x,\theta)dx
$$

미분이 극한으로 정의된다는 것을 다시 기억하자.